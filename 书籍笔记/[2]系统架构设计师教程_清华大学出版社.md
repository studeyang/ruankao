> 视频资料：https://www.bilibili.com/video/BV1r54y1V7dC/?spm_id_from=333.788.b_7265636f5f6c697374.6

# 第1章 绪论

**1.1 系统架构的概念及其发展历史**

概念、发展历史

**1.2 系统架构师的定义与职业素质**

定义、技术素质、管理素质、协调能力

**1.3 系统架构师知识结构**

技术路线引导者、“多层次+多方面”

**1.4 从开发人员到架构师**

一名合格的软件架构师的成长应该要有8年以上的工作经验。

此外，得到并利用机会、不断总结自己的架构模式。机遇+努力+天赋的综合结果。

软件架构师认证情况：<br>1. UC Irvine；2. CMU/SEI；3. iCMG；

# 第2章 计算机与网络基础知识

**2.1 操作系统基础知识**

操作系统的原理、类型和结构。

处理机与进程管理。

进程互斥与同步，PV操作。

存储管理。

**2.2 数据库系统基础知识**

关系数据库基础；

关系数据库设计；

分布式数据库系统；

商业智能；

**2.3 计算机网络基础知识**

网络七层模型。

网络管理与网络安全。

**2.4 多媒体技术及其应用**

多媒体技术基本概念。

**2.5 系统性能**

阿姆达尔定律。

# 第3章 信息系统基础知识

**3.1 信息化概述**

信息的特征。

信息化的定义。

信息化的内容。

信息化的经济社会意义。

信息化战略。

**3.2 信息系统工程总体规划**

信息系统工程总体规划的目标范围。

信息系统工程总体规划的方法论。

**3.3 信息化的典型应用**

8点。

# 第4章 系统开发基础知识

**4.1 软件开发方法**

软件开发生命周期。

软件开发模型。

敏捷方法。

RUP（Rational Unified Process）。

**4.2 需求管理**

需求管理原则。

需求变更。

**4.3 开发管理**

项目的范围、时间、成本。

配置管理、文档管理。

**4.4 设计方法**

结构化分析与设计。

面向对象的分析设计。

逆向工程与重构工程。

**4.5 软件的重用**

**4.6 逆向工程与重构工程**

# *第5章 软件架构设计

**5.1 软件架构概念**

软件架构的生命周期；

软件架构的重要性；

**5.2 基于架构的软件开发方法**

基于体系结构的软件设计方法；

**5.3 软件架构风格**

经典软件体系结构风格；

客户/服务器风格；

**5.4 特定领域软件体系结构**



**5.5 系统架构的评估**



# 第6章 UML 建模与架构文档化

**6.1 UML现状与发展**

UML起源；

UML体系结构演变；

**6.2 UML基础**



**6.3 基于UML的软件开发过程**



**6.4 系统架构文档化**



# 第7章 设计模式



# 第8章 XML技术

**8.1 XML概述**

XML文档的组成；

XML元素；

**8.2 XML命名空间**



**8.3 DTD**

内部DTD声明；

外部DTD声明；

**8.4 XML Schema**



**8.5 可扩展样式表语言**



**8.6 其他相关规范**



# *第9章 面向构件的软件设计

> 主要为概念题，单选/案例分析：占4~20分

**9.1 构件的概念**

**9.2 构件的布线标准**

**9.3 构件框架**

# 第10章 构件平台与典型架构

了解各个平台特点和差异，为应用开发选择合适的构件开发平台。

**10.1 OMG方式**

- 对象请求代理

  ORB：对象请求代理

  ![image-20200824233946195](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200824233946195.png)

- 公共对象服务规范

  支持企业分布式计算的服务：

  命名服务，交易器服务；事件服务，通告服务；对象事务服务；安全服务；支持细粒度对象互操作的服务；

  并发控制服务；许可服务；生命周期服务；关系服务；持久状态服务；

  外部化服务；属性服务；对象查询服务；对象集合服务；时间服务；

- CORBA构件模型

  可移植对象适配器；CCM构件；CCM容器；

- CORBA设施

  CORBA设施可以分为水平的和垂直的支持。

  水平设施：用户界面、信息管理、系统管理和任务管理；

  垂直设计：商业企业集成命令控制、计算机通信和集成、财政、卫生保健、生命科学研究、制造业、空间、电信、运输和共用设施建设。

**10.2 SUN公司的方式**

- Java构件技术的概述

  Applet是Java中最初引起广泛关注并取得突破的地方。

  Java 2平台打破原有框架，并将Applet改变成一个边缘的角色。

  JRE是J2SE平台的一部分，而J2SE本身又是J2EE平台的一个子集。

- JavaBean

  用Bean来指代构件，用Bean实例来指代构件对象。

  Bean模型主要包括以下几个方面：事件、属性、自检、定制、持久化。

- 基本的Java服务

  反射、对象序列化、Java本地接口(JNI)、Java AWT和JFC/Swing

- 各种构件

  Applet、Servlet、Bean 和 Enterprise Bean。

  Applet是第一个Java构件模型，第二个是JavaBean，第三个EJB，第四个是Servlet，J2EE引入的第五种Java构件模型为应用客户端构件。

- 高级Java服务

  分布式对象模型和RMI；Java和CORBA；企业级服务接口；J2EE连接器架构(JCA)；Java和XML；

**10.3 Microsoft的方式**

- COM

  第一个基础关联模型--COM。COM所定义的一个基础实体是接口。

- COM对象重用

  COM不支持任何形式的实现继承，COM支持两种形式的对象组装：包含（Containment）和聚集（Aggregation）。

  

**10.4 战略比较**

- 共性

  所有的方法都依赖于延后绑定机制、封装和动态多态性。

- 不同点

  1. 每个平台的二进制接口标准；

  2. 兼容性和可移植性的源代码级的标准；
  3. 逐渐形成的和仓促造就的标准；
  4. 内存管理、生命周期和垃圾回收；
  5. 容器管理的持久性和关系；
  6. 演化和版本的概念；
  7. 分类的概念；
  8. 产业界的实现支持及应用状况；
  9. 开发环境；服务；部署；网络服务构件；传输；

# 第11章 信息安全技术

**11.1 信息安全关键技术**

- 加密和解密技术

  消息的发送者称为信源；消息的目的地称为信宿；没有加密的消息称为明文；加密后的消息称为密文；用来传输消息的通道称为信道；

  对称密钥密码体制及典型算法：DES算法、IDEA算法。

  不对称密码加密算法：RSA密码体制；

- 散列函数与数字签名

  常见的散列函数有MD5、SHA和HMAC等。

  数字签名：RSA、ElGamal、Fiat-Shamir、美国的数字签名标准/算法（DSS/DSA）、椭圆曲线等多种。

  数字水印：主要应用于版权保护、标题与注释、篡改提示、使用控制。典型数字水印算法有空域算法、变换域算法、压缩域算法、NEC算法和生理模型算法。

- 密钥分配中心与公钥基础设施

  密钥分配中心（KDC）有效实现密钥自动分配；

  数字证书：数字证书提供了一个在公钥和拥有相应私钥的的实体之间建立关系的机制；

  公钥基础设施：PKI(Public Key Infrastructure)的目标是向广大的信息系统用户和应用程序提供公开密钥的管理服务；

- 访问控制

  身份认证技术：用户名和口令认证、使用令牌认证、生物识别与三因素认证；

  访问控制技术：入网访问控制、网络权限控制、目录级安全控制、属性安全控制以及网络服务器的安全控制等。

- 安全协议

  IPSec协议、SSL协议、PGP协议

- 数据备份

  备份的类型：完全备份、差异备份、增量备份、按需备份；

  异地备份：数据异地备份是容灾系统的核心技术；

  自动备份软件：自动备份精灵、GHOST自动备份、DiskWin自动备份；

  新型的备份解决方案：网络备份模式、用存储网络备份、磁带和磁带之间直接传输数据的备份；

- 计算机病毒与免疫

  计算机病毒：定义、基本特征、分类；

  计算机病毒免疫的原理：针对某一种病毒的免疫、基于自我完整性检查的免疫；

**11.2 信息安全管理和评估**

- 安全管理技术

  安全管理技术就是监督、组织和控制网络通信服务以及信息处理所必需的各种技术手段和措施的总称。

  安全管理的发展现状：受技术实力限制，大多是针对自己的安全设备开发的集中管理软件、安全审计系统等。

  网络安全管理技术：安全设备管理、安全策略管理、安全分析控制、安全审计。

  安全管理主要解决的问题：集中化的安全策略管理、实时安全监视、安全联动机制、配置与补丁管理、统一的权限管理。

  安全性规章：计算机信息系统安全保护等级划分标准、计算机信息安全保护条例。

**11.3 信息安全保障体系**

1. 建立统一的身份认证体系；
2. 建立统一的信息安全管理体系；
3. 建立规范的信息安全保密体系；
4. 建立完善的网络边界防护体系；

# 第12章 系统安全架构设计

**12.1 信息系统安全架构的简单描述**

- 信息安全的现状及其威胁

  ![image-20200826230729413](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826230729413.png)

  常见的安全威胁有：信息泄露、破坏信息的完整性、拒绝服务、非法使用、窃听、业务流分析、假冒、旁路控制、授权侵犯、特洛伊木马、陷阱门、抵赖、重放、计算机病毒、人员不慎、媒体废弃、物理侵入、窃取、业务欺骗。

- 国内标准和组织

  GA163-1997(计算机信息系统安全专用产品分类原则)；

  GB17895-1999(计算机信息系统安全保护等级划分准则)；

  GB/T9387.2-1995(信息处理系统开放系统互连基本参考模型第二部分安全体系结构)；

  GB 15834.1-1995(信息处理数据加密实体鉴别机制第一部分：一般模型)；

  GB 4943-1995(信息技术设备的安全)；

  组织：ISO、信息技术安全分技术委员会。

**12.2 系统安全体系架构规划框架及其方法**

安全技术体系架构的目标是建立可持续改进的安全技术体系架构。

根据网络中风险威胁划分出5个层次的实体对象：应用、存储、主机、网络和物理。

信息系统安全体系的框架如下图所示：

![image-20200826233012626](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826233012626.png)

规划的具体环节、相互之间的关系和具体方法如下图所示：

![image-20200826233235493](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826233235493.png)

**12.3 网络安全体系架构设计**

- OSI的安全体系架构概述

  在OSI 7层协议中除第5层（会话层）外，每一层均能提供相应的安全服务，最适合配置安全服务的是在物理层、网络层、运输层及应用层上，其他层都不宜配置安全服务。

  ISO开放系统互联安全体系的5类安全服务包括鉴别、访问控制、数据机密性、数据完整性和抗抵赖性。

  ![image-20200826234135311](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826234135311.png)

- 鉴别框架

  鉴别的方式主要基于以下5种：

  已知的，如一个秘密的口令；

  拥有的，如IC卡、令牌等；

  不改变的特性，如生物特征；

  可靠的第三方建立的鉴别；

  环境（如主机地址等）。

- 访问控制框架

  访问控制决定开放系统环境中允许使用哪些资源、在什么地方适合阻止未授权访问的过程。

  基本访问控制功能示意图如下：

  ![image-20200826234917857](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826234917857.png)

  ADF示意图如下：

  ![image-20200826235009083](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200826235009083.png)

- 机密性框架

  机密性的机制：通过禁止访问提供机密性、通过加密提供机密性；

- 完整性框架

  完整性机制的类型：阻止对媒体访问的机制、用以探测对数据或数据项序列的非授权修改的机制。

- 抗抵赖框架

  抗抵赖服务包括证据的生成、验证和记录，以及在解决纠纷时随即进行的证据恢复和再次验证。

  抗抵赖由4个独立的阶段组成：

  证据生成；

  证据传输、存储和恢复；

  证据验证；

  解决纠纷；

**12.4 数据库系统的安全设计**

- 数据库安全设计的评估标准

  可信计算机系统评估标准（Trusted Computer System Evaluation Criteria, TCSEC）将安全系统分为4大类7个等级。D类产品是基本没有安全保护措施的产品，C类产品只提供了安全保护措施，，一般不称为安全产品，B类以上产品是实行强制存取控制的产品，也是真正意义上的安全产品。

- 数据库的完整性设计

  数据库完整性设计原则：

  1. 根据数据库完整性约束确定其实现方式，并提前考虑对系统性能的影响；
  2. 用一定的时间和空间来换取系统的易用性是值得的；
  3. 慎用DBMS的触发器功能；
  4. 尽量使用有意义的英文单词、缩写词、表名、列名及下划线等组合；
  5. 要根据业务规则对数据库完整性进行细致的测试；
  6. 要有专职的数据库设计小组，自始至终负责数据库的分析、设计、测试、实施及早期维护；
  7. 应采用合适的CASE工具来降低数据库设计各阶段的工作量；

  数据库完整性的作用：

  1. 防止用户向数据库中添加不合语义的数据；
  2. 基于DBMS的完整性控制机制来实现业务规则，易于定义，容易理解；
  3. 合理的数据库完整性设计，能够同时兼顾数据库的完整性和系统的效能；
  4. 在功能测试中，完善的数据库完整性有助于迟早发现软件的错误；
  5. 数据库完整性约束可分为6类：列级静态约束、元组级静态约束、关系级静态约束、列级动态约束、元组级动态约束和关系级动态约束；

  数据库完整性设计示例：

  1. 需求分析阶段；
  2. 概念结构设计阶段：即实体关系图概念模型；
  3. 逻辑结构设计阶段：将概念结构转换为数据模型；

**12.5 案例：电子商务系统的安全性设计**

- 原理介绍

  1. 验证（Authentication）：验证用户是否可以获得访问权，认证信息包括用户名、用户密码和认证结果等；
  2. 授权（Authorization）：授权用户可以使用哪些服务，授权包括服务类型及服务相关信息等；
  3. 审记（Accounting）：记录用户使用网络资源的情况，用户IP地址、MAC地址掩码等；

- 软件架构设计

  ![image-20200828000103089](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200828000103089.png)

  软件架构分为三个层面：协议逻辑层、业务逻辑层和数据逻辑层。

  功能方面：一是实际处理大量用户并发的能力，二是软件架构的可扩展性。

# 第13章 系统的可靠性设计

**13.1 软件可靠性**

- 软件可靠性概述

  目前，软件可靠性管理方面还没有建立起具有权威性的管理体系和规范。

- 软件可靠性的定义

  可靠性（Reliability）是指产品在规定的条件下和规定的时间内完成规定功能的能力。

  软件与硬件从可靠性的角度来看，主要有如下4个不同点：

  1. 复杂性：软件内部逻辑高度复杂，硬件则相对简单；
  2. 物理退化：硬件失效主要是由于物理退化的所致；
  3. 唯一性：任何两个硬件不可能绝对相同；
  4. 版本更新较快：硬件产品一旦定型一般就不会更改，而软件产品通常更新较快；

  软件可靠性的定义：

  在规定的条件和时间内，软件不引起系统失效的概率（该概率是系统输入和系统使用的函数，也是软件中存在的缺陷函数）。

  软件可靠性的特点：

  1. 内在的“缺陷”和外在的“失效”；
  2. 软件可靠性量化评估；
  3. 概率描述可靠性；

- 软件可靠性的定量描述

  1. 规定时间：自然时间、运行时间（软件启动至结束）、执行时间（CPU使用时间）；
  2. 失效概率：可用函数F(t)表示，F(0)=0，F(t)在时间域(0,+无穷)单调递增，F(+无穷)趋向于1；
  3. 可靠度：软件系统在规定的条件下、规定的时间内不发生失效的概率；
  4. 失效强度：单位时间软件系统出现失效的概率；
  5. 失效率：单位时间软件系统出现失效的概率；
  6. 平均失效时间：软件运行后到下一次出现失效的平均时间；

- 可靠性目标

  可靠性目标是指客户对软件性能满意程度的期望；

  ![image-20200828235313249](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200828235313249.png)

- 可靠性测试的意义

  1. 软件失效可能造成灾难性的后果；
  2. 软件的失效在整个计算机系统失效中的比例较高；
  3. 软件可靠性技术较硬件很不成熟；
  4. 软件可靠性问题是造成费用增长的主要原因之一；
  5. 系统对于软件 的依赖性越来越强；

- 广义的可靠性测试与狭义的可靠性测试

  广义的软件可靠性测试是指为了评价系统的可靠性而运用建模、统计、试验 、分析和评价等一系列手段对软件系统的一种测试；

  狭义的软件可靠性测试是指为了获取可靠性数据，按预先确定的测试用例，在软件的预期使用环境中，对软件实施的一种测试；

**13.2 软件可靠性建模**

- 影响软件可靠性的因素

  运行剖面（环境）、软件规模、软件内部结构、软件的开发方法和开发环境、软件的可靠性投入。

- 软件可靠性建模方法

  一个软件可靠性模型通常由以下部分组成：模型假设、性能度量、参数估计方法、数据 要求。

  绝大多数的模型包含三个共同假设：代表性假设、独立性假设、相同性假设。

  一个好的软件可靠性模型应该具有如下特性：

  基于可靠的假设、简单、计算一些有用的量、给出未来失效行为的好的映射、可广泛应用。

- 软件的可靠性模型分类

  可靠性模型可分为如下10类：种子法模型、失效率类型模型、曲线拟合类模型、可靠性增长模型、程序结构分析模型、输入域分类模型、执行路径分析方法模型、非齐次泊松过程模型、马尔可夫过程模型、贝叶斯分析模型。

- 软件可靠性模型举例

  Jelinski-Moranda模型（JV模型）是最具代表性的马尔可夫过程的数据模型，随后的许多工作都是在它的基础上进行改进而提出来的。

  模型假设：在任何一个失效间隔区间，软件系统的失效率与系统中剩余的错误个数成正比；

  函数表达式：根据假设推算出函数表达式；

  参数估计：运用统计学中的最大似然法来对参数进行估算；

- 软件可靠性测试概述

  划分测试：按行为或结构来划分输入域；

  随机测试：随机选择输入；

  覆盖测试：基于功能、路径、数据流或控制流；

  软件可靠性测试主要活动组成：可靠性目标的确定、运行剖面的开发、测试用例的设计、测试实施、测试结果的分析；

- 定义软件运行剖面

  软件系统可能会有许多用户和用户类别，每类用户都可能以不同的方式使用系统。软件 使用模型涉及到将输入域分层，有2种类型的分层形式：用户级分层和用法级分层；

  软件可靠性测试假设每个操作的数据输入都有同样的发生错误的概率 ，这样最频繁出现 的操作和输入将表现出最高的故障率。

- 可靠性测试用例设计

  一个典型的测试用例应该包括下列组成部分：

  测试用例标识 、被测对象、测试环境及条件、测试输入、操作步骤、预期输出 、判断输出结果是否符合标准、测试对象的特殊需求。

- 可靠性测试的实施

  1. 软件可靠性测试必须是受控测试；
  2. 软件可靠性测试依赖于软件的可测试性；
  3. 软件可靠性数据是可靠性评价的基础；

  用时间定义的软件可靠性数据可以分为4类：失效时间数据 、失效间隔时间数据、分组时间内的失效数、分组时间的累积失效数；

  测试过程中每个测试记录必须包含如下信息：测试时间、含有测试用例的测试说明或标识、所有与测试有关的测试结果（包括失效数据）、测试人员；

  测试报告应具备如下内容：

  软件产品标识 、测试环境配置（硬件和软件）、测试依据、测试结果 、测试问题、测试时间；

**13.3 软件可靠性评价**

- 软件可靠性评价概述

  可以使用软件可靠性模型，估计软件当前的可靠性，结合可靠性验证测试，确定最终软件产品所达到的可靠性水平。

  评估和预测软件可靠性的过程包含三个方面：选择可靠性模型、收集可靠性数据、可靠性评估和预测；

- 怎样选择可靠性模型

  可以从以下几个方面进行比较和选择：

  1. 模型假设的适用性：如果现有的软件系统对于严重程序类较低的软件缺陷不进行立即排错，那么这个模型显然是不适用的；
  2. 预测的能力与质量：预测将来的可靠性和失效概率的能力，以及预测结果的准确程度；
  3. 模型输出值能否满足可靠性评价需求：当前的可靠度、平均失效时间、故障密度、期望达到规定可靠性目标的日期、达到规定的可靠性目标的成本要求；
  4. 模型使用的简便性：模型易于收集、模型简单易懂、模型便于使用；

- 可靠性数据的收集

  1. 及早确定所采用的可靠性模型；
  2. 制定可实施性较强的可靠性数据收集计划；
  3. 重视软件测试特别是可靠性测试产生的测试数据的整理和分析；
  4. 充分利用数据库来完成可靠性数据的存储和统计分析；

- 软件可靠性的评估和预测

  软件可靠性评估和预测以软件可靠性模型分析为主，以下方法为辅：

  1. 失效数据的图形分析法；
  2. 试探性数据分析技术；

**13.4 软件的可靠性设计与管理**

- 软件可靠性设计

  软件可靠性设计技术就是以提高和保障软件的可靠性为目的，在软件设计阶段运用的一种特殊的设计技术。

  容错设计技术：恢复块设计、N版本程序设计和冗余设计；

  检错技术：检测对象、检测延时、实现方式、处理方式；

  降低复杂度设计：在保证实现软件功能的基础上，简化软件结构，缩短程序代码长度，优化软件数据流向，降低软件复杂度，从而提高软件可靠性。

- 软件可靠性管理

  需求分析阶段 -> 概要设计阶段 -> 详细设计阶段 -> 编码阶段 -> 测试阶段 -> 实施阶段。

# 第14章 基于 ODP 的架构师实践

**14.1 基于ODP的架构开发过程**

开放分布进程的参考模型（RM-ODP）定义了分布式系统的重要性质：开放性、整体性、灵活性、可塑性、联合性、可操作管理性、优质服务、安全性和透明性；

RM-ODP定义了5个视点：企业视点、信息视点、计算视点、工程视点、技术视点；

下图展示了整个系统及架构开发的10个过程：

![image-20200831233639099](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200831233639099.png)

**14.2 系统构想**

- 系统构想的定义

  系统构想是指一个系统开发人员与系统用户之间的协议。

- 架构师的作用

  系统构想阶段架构师合理介入有以下好处：

  有利于使系统架构师本身对系统的看法更加全面、准确；

  有利于统一系统开发人员对系统的看法；

  有利于正确确定需求的优先次序；

  通过系统构想，可以提高客户参与度，更好地与客户沟通；

- 系统构想面临的挑战

  1. 架构师对其控制能力之外的因素通常无能为力；
  2. 架构师把架构看成是他们独自的创造，而且只要他们认为合适就进行修改；
  3. 由于没有参与架构师的招聘工作，高级经理将无法评估架构师的能力；

**14.3 需求分析**

- 架构师的工作

  1. 系统范围对象关系图；
  2. 用户接口原型；
  3. 需求的适用性；
  4. 确定需求的优先级；
  5. 为需求建立功能结构模型；
  6. 使用质量功能分配；

- 需求分析的任务

  需求分析的目的：完整、准确地描述用户对系统的需求，跟踪用户需求的变化；

  需求分析的特点：完整性、一致性、验证性；

- 需求文档与架构

  每个用例都有一个相关需求的文字描述，用例为定义架构提供了一个系统的领域行为模型；

  用户界面的外观、功能和导航同用例紧密相联。

  有了用例和定义的用户界面以及领域概念模型，我们建立了架构规划的环境。

**14.4 系统架构设计**

- 企业业务架构

  企业业务架构包含如下内容：

  1. 企业的业务和战略目标；
  2. 企业的组织机构；
  3. 业务的分类；
  4. 各类业务之间的关系；
  5. 组织机构与业务的关系；
  6. 企业与外部机构的关系；

- 逻辑信息架构

  逻辑信息架构标识出系统必须知道什么。

- 计算接口架构

  它定义了顶层的应用程序接口，在实现中，开发者将对他们的模型在这些边界上进行编程，以消除多个开发者和小组的主要设计争端。

- 分布式工程架构

  分布式工程架构定义了底层结构的需求，而独立于所选择的技术。它很好地解决了一些最复杂的系统策略，其中包括物理位置、系统规模可变性和通信服务质量。

- 技术选择架构

  阶段1原型--Java应用程序：它由一个独立的Java应用程序以及一个平面文件数据库配置而成；

  阶段2原型：使用分布式基础设施中的RMI或者IIOP技术，支持局域网上的多客户系统；

  阶段3原型：支持数据库的可扩展性，这是通过把平面文件替换为JDBC接口及其操作的后端数据库来实现的；

**14.5 实现模型**

用户和架构师应在一起审查用例来证实需求的有效。通常这个交流会出现新的或者需要修改的需求，对于需求的任何修改都要标注并结合到随后的其他架构活动中去。

**14.6 架构原型**

构架原型是很好的需求验证工具，它能够帮助利益相关人检测系统锲合用户操作的程度。利用架构原型，至少有下面几个好处：

1. 在架构落实之前，让团队成员能自由发表他们自己的看法，并进行讨论，提出建议，对在架构原型中存在的问题进行及时改正；
2. 可以在系统的整体性能上，把握得更好。统一团队成员之间的思想看法和提高系统开发的成功率；
3. 它对系统内部的结构分析与设计也有帮助；

**14.7 项目规划**

项目规划的主要作用是将制定规划的范围、成本、进度的基线等用正式的文档记录保存。

项目规划是项目工作的纲领，要以此去指导项目的技术和管理活动。项目规划包括如下内容：

1. 项目的目的、范围、目标和对象；
2. 软件生存周期的选择；
3. 精选的供开发和维护软件用的规程、方法和标准；
4. 待开发的软件工作产品；
5. 软件工作产品的规模估计、软件项目的工作量和成本的估计；
6. 关键计算机资源的估计，项目的里程碑；
7. 风险的识别和评估；
8. 工程设施和支持工具计划；

**14.8 并行开发**

- 软件并行开发的内容及意义

  内容：

  1. 软件过程及其模型；
  2. 并行成分划分；
  3. 并行控制；
  4. 支持环境；
  5. 交互机制与集成技术；

  意义：

  在于提高软件生产率和改善软件质量，软件并行开发有效地组织可以重复的资源，并附加额外的控制管理技术，使软件开发尽量并行进行，从而达到加快软件开发速度、提高软件生产率、缩短软件开发周期的目的。

- 并行开发的过程

  软件系统的开发过程划分为若干个可以并行的成分，这个成分称之为开发过程。

  ![image-20200902002055532](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200902002055532.png)

**14.9 系统转换**

- 系统转换的准备

  在系统转换前，必须认真做好系统设备、数据、人员以及有关文件的准备；除此之外，还需要系统试运行这项准备工作。

- 系统转换的方式

  系统转换可分为：

  直接转换：当新系统安装完毕能够进行工作后，立即停止旧系统的运行，让新系统投入运行；

  平等转换：新旧系统共同工作一段时间，当证实新系统有较高的可靠性后，再停止旧系统工作的转换方式；

  分段转换：一次只用新系统的部分功能去替换旧系统的相应部分，逐步完成新系统替换旧系统；

  分批转换：把新系统在小范围内使用，然后再全部推广；

- 系统转换的注意事项

  1. 新系统的运行需要大量的基础数据 ；
  2. 系统的转换不仅仅是机器的转换、程序的转换，更难的是人员的转换，应提前做好人员的培训工作；
  3. 系统运行时会出现一些局部性的问题，系统工作人员对此应有足够的准备，并做好记录。

**14.10 操作与维护**

- 操作与维护的内容

  数据管理与维护：数据收集、数据整理、数据录入、数据分发、数据库管理工作；

  机器设备的管理与维护：硬件维护、机器日常行政管理、系统操作记录、用户服务；

  系统软件的管理与维护：代码维护；

- 系统维护与架构

  系统的可维护性有如下几个评价指标：可理解性、可测试性、可修改性；

  系统维护工作可以分为以下4种类型：更正性维护、适应性维护、完善性维护、预防性维护；

**14.11 系统移植**

- 系统移植的形式

  第一种是不修改已有的软件。可以使用的方法有高位互换、仿真功能和虚拟机功能；

  第二种是修改软件。把已有软件资源，程序、数据、计算机应用方法及各种说明书转换为与新机器具有匹配性的软件；

  第三种是重编软件。从逻辑设计开始、从程序设计开始和从编程开始三种开发方式；

- 系统移植的工作阶段划分

  计划阶段、准备阶段、转换阶段、测试阶段、验证阶段

- 系统移植工具

  分析工具、生成工具、转换工具、数据应用工具、测试验证工具、管理工具

# 第15章 架构师的管理实践

**15.1 VRAPS组织管理原则 **

VRAPS是为实践软件架构的组织管理原则提出的，包括构想、节奏、预见、协作和简化5个相关联的原则。

构想原则：说明了如何向架构的受益人描述一幅未来图景；

节奏原则：定期地根据可预测的速度、内容和质量对制品生产进行检查与规划；

预见原则：要在预测未来与适应现状之间做出平衡；

简化原则：了解架构最小的基本特征并最小化架构；

![image-20200902224804559](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200902224804559.png)

**15.2 概念框架**

准则：把原则运用到实践中，需要可操作的实施细节；

模式：描述了使用软件架构时可能遇到的问题及解决方法；

反模式：描述了组织在实践中可能遇到的陷阱；

**15.3 形成并统一构想**

- 形成构想

  形成架构构想的三步方法：

  1. 清楚明确地阐述一条迫切的客户价值；
  2. 将客户价值映射为能解决的问题；
  3. 将以上问题转译成一组特定的约束条件；

- 将构想原则付诸实践

  准则1：架构师的构想与发起人、用户、最终客户期望实现的目标是否保持一致；

  准则2：实施人员信任并使用架构；

  准则3：关于架构和构件的潜藏知识对其用户是可见的、可获得的；

**15.4 节奏：保证节拍、过程和进展**

- 节奏定义

  节奏有三个元素：速度、内容和质量；

- 将节奏原则付诸实践

  准则1：经理们定期地再评估、同步和调整架构；

  准则2：架构用户对架构发布的进度和内容具有高度的信心；

  准则3：通过节奏协调明确的活动；

**15.5 预测、验证和调整**

- 预测、验证和调整的定义

  预测：既然一个成功的架构将被持续使用很长时间，架构师至少要对未来将发生什么做出合理的猜测；

  验证：验证不仅局限于传统软件工程的测试和检查技术，也包括对架构的基础假定的测试；

  调整：对架构计划及架构本身修正以加入新特性，从而能参与新兴市场的竞争或者在新的环境中生存；

- 将预见原则付诸实践：准则、反模式与模式

  准则1：不断增强架构的能力以响应预见到的风险和客户的需求，市场的技术演变，战略性业务方向的变化；

  准则2：通过快速复审和开发周期，评估技术和业务上的风险与机会；

  准则3：当认识到关键的估计或假设有错时，及时调整功能特性、预算；

**15.6 协作：建立合作型组织**

- 协作定义

  指架构受益人保持明确的、合作的角色并将其所提供的价值最大化；

- 将协作原则付诸实践：准则、反模式与模式

  准则1：架构师不断地了解谁是最关键的受益人，他们如何贡献价值，以及他们需要什么；

  准则2：受益人之间达成明确和强制性的契约；

  准则3：通过社会行为制度和非正式规范强化合作；

**15.7 简化：澄清与最小化**

- 简化定义

  简化是指将所作用组织与环境都进行巧妙地理解与最小化，组织形成架构并且思考架构。

- 将简化原则付诸实践：准则、反模式与模式

  准则1：开发人员长期不断地使用架构，减少了总成本和复杂性；

  准则2：架构小组明确理解关键最小需求，并且将其构造成多应用共享的核心元素；

  准则3：通过长期的预算和行动确保当相关元素没有被共享、增加了不必要的复杂性时，或者是因为有明确的业务理由时，把相关元素从核心移走；

# 第16章 层次式架构设计

**16.1 体系结构设计**

定义：软件体系结构为软件系统提供了结构、行为和属性的高级抽象。

作用：

1. 利益相关人员之间的交流；
2. 系统设计的前期决策；
3. 可传递的系统抽象；

**16.2 表现层框架设计**

- 使用MVC模式设计表现层

  控制器：接受用户的输入并调用模型和视图去完成用户的需求；

  模型：表示业务数据和业务逻辑；

  视图：用户看到并与之交互的界面；

  ![image-20200903231609647](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200903231609647.png)

  优点：

  1. 允许多种用户界面的扩展；
  2. 易于维护；
  3. 功能强大的用户界面；

- 使用XML设计表现层，统一Web Form与Windows Form的外观

  从设计模式的角度来说，整个XML表现层解析的机制是一种策略模式。在调用显示 GUI 时，不是直接的调用特定的表现技术的 API，而是装载GUI对应的XML配置文件，然后根据特定的表现技术的解析器解析XML，得到GUI视图实例对象。

  这样，对于 GUI 开发人员来说，GUI 视图只需要维护一套 XML 文件即可。

- 表现层中的 UIP 设计思想

  UIP(User Interface Process Application Block)提供了一个扩展的框架，用于简化用户界面与商业逻辑分离的方法。

  UIP 框架的应用程序把表现层分为了以下几层：

  ![image-20200903233935987](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200903233935987.png)

  UIP 组件的主要功能：

  1. 管理经过 User Interface Components 的信息流；
  2. 修改用户过程的流程以响应异常；
  3. 将概念上的用户交互流程从实现或者涉及的设备上分离出来；
  4. 保持内部的事务关联状态；

- 表现层动态生成设计思想

  界面定制是对用户界面的动态修改过程，在软件运行过程中，用户可按需求和使用习惯，对界面元素（如菜单、工具栏）的属性（如文字、图标、大小和位置等）进行修改。软件运行结束，界面定制的结果被保存；

**16.3 中间层架构设计**

- 业务逻辑层组件设计

  业务逻辑组件分为接口和实现类两个部分；

- 业务逻辑层工作流设计

  定义：业务流程的全部或部分自动化，在此过程中，文档、信息或任务按照一定的过程规则流转，实现组织成员间的协调工作以达到业务的整体目标；

- 业务逻辑层实体设计

  业务逻辑层实体提供对业务数据的状态访问。

- 业务逻辑层框架

  业务框架位于系统架构的中间层，是实现系统功能的核心组件。

  ![image-20200904000716369](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200904000716369.png)

  Domain Model 是领域层业务对象，它仅仅包含业务相关的属性；

  Service 是业务过程实现的组成部分；

  Control 服务控制器实现不服务之间的切换；

**16.4 数据访问层设计**

- 5种数据访问模式

  在线访问：占用一个数据库连接；

  DAO：Data Access Object；

  DTO：Data Transfer Object；

  离线数据模式：数据从数据源获取后，按照某种预定义的结构存放在系统中，成为应用的中心；

  对象/关系映射：Object/Relation Mapping；

- 工厂模式在数据访问层应用

  ```java
  public interface DataAccess {
      void open();
      void close();
      IDbTransaction beginTransaction();
  }
  ```

  ```java
  public class MSSqlDataAccess extends AbstractDataAccess {
      // ...具体实现代码
  }
  
  public class OleDbDataAccess extends AbstractDataAccess {
      // ...具体实现代码
  }
  
  public class OracleDataAccess extends AbstractDataAccess {
      // ...具体实现代码
  }
  ```

  下面需要创建一个`Factory`类，来实现自动数据库切换的管理。

  ```java
  public class DataAccessFactory {
      private static PersistenceProperty defaultPersistenceProperty;
      public static DataAccess createDataAccess(PersistenceProperty pp) {
          DataAccess dataAccess;
          switch(pp.databaseType) {
                  case(DatabaseType.MSSQLServer):
                  dataAccess = new MSSqlDataAccess(pp.connectionString);
                  break;
                  case(Database.Oracle):
                  dataAccess = new OracleDataAccess(pp.connectionString);
                  break;
                  // ...
          }
          return dataAccess;
      } 
      public static DataAccess createDataAccess() {
          return createDataAccess(defaultPersistenceProperty);
      }
  }
  ```

  客户端调用：

  ```java
  PersistenceProperty pp = new PersistenceProperty();
  pp.connectionString = "server=127.0.0.1;uid=sa;pwd=;database=Northwind;";
  pp.databaseType = DatabaseType.MSSQLServer;
  pp.userId = "sa";
  pp.password = "";
  DataAccess db = DataAccessFactory.createDataAccess(pp);
  db.open();
  // ...db需要的操作
  db.close();
  ```

- ORM、Hibernate与CMP2.0设计思想

  ORM框架把数据库转变成我们熟悉的对象；

  Hibernate 对JDBC进行了轻量级的对象封装；

- 灵活运用Xml Schema

  XML Schema用来描述XML文档合法结构、内容和限制；

- 事务处理设计

  1. JavaBean中使用JDBC方式进行事务处理；

  2. SessionBean中的JTA事务；

     JTA具有三个主要的接口：UserTransaction、TransactionManager、Transaction；

- 连接对象管理设计

  解决资源频繁分配、释放所造成的问题；

**16.5 数据架构规划与设计**

- 数据库设计与类的设计融合

  对一个给定的复杂情况而言，不存在唯一正确的数据模型，然而却存在好的数据模型。

- 数据库设计与XML设计融合

  XML文档的存储方式有两种：

  1. 基于文件的存储方式：将XML文档按其原始文本形式存储；
  2. 数据库存储方式：管理方便、存储占用空间小、检索速度快、修改效率高和安全性好等优点；

**16.6 实战案例--网上商店PetShop**

- PetShop的系统架构设计

  PetShop 1.0采用标准的BS分层式结构。

  ![image-20200905001328063](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905001328063.png)

  PetShop 2.0采用标准的三层式结构。缺点：一旦要求支持的数据库发生变化，或者需要修改数据访问的逻辑，会导致项目做大的修改。

  ![image-20200905001521662](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905001521662.png)

  PetShop 3.0纠正了层次不明的问题。

  ![image-20200905001901168](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905001901168.png)

  PetShop 4.0延续了3.0的结构，但在性能上作了一定的改进，引入了缓存和异步处理机制。

  ![image-20200905002218351](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905002218351.png)

- 3.0 与 4.0 的比较

  相同点：

  1. 在数据访问层（DAL），仍然采用DAL Interface抽象出数据访问逻辑，并以DAL Factory作为数据访问层对象的工厂模块；
  2. 都采用了“面向接口编程”思想，抽象出来的IDAL模块，脱离了与具体数据库的依赖，从而使得整个数据访问层有利于数据库迁移；

# 第17章 企业集成架构设计

**17.1 企业集成平台**

- 企业集成平台的概念

  一方面，企业中各种业务信息系统数量的增加为企业集成平台产生了需求拉动的作用；另一方面，计算机及软件技术的发展是产生企业集成平台的技术推动力；

  企业集成系统功能主要如下 ：

  1. 通信服务：提供透明的同步/异步通信服务功能；
  2. 信息集成服务：为应用提供透明的信息访问服务；
  3. 应用集成服务：通过高层应用编程接口来实现对相应应用程序的访问；
  4. 二次开发工具：是集成平台提供的一组帮助用户开发特定应用程序的支持工具；
  5. 平台运行管理工具：是企业集成平台的运行管理和控制模块；

- 集成平台的标准化

  集成平台的标准化内容涉及通信协议、中间件、企业建模、工作流管理系统、Internet环境下的数据交换、产品数据标准和应用系统集成的标准等；

- 实现技术的发展趋势

  1. 集成的技术实现从2层到n层过渡；
  2. 集成支持的方式从面向信息集成扩充到面向过程集成、服务集成；
  3. 集成规范的标准化程度不断提高；
  4. 所支持的集成耦合度及集成的粒度的变化；

- 集成平台的发展趋势

  1. Active Enterprise 3.0(Tibco公司)
  2. Mercator(Mercator公司)
  3. MQ Series Integrator(IBM公司)
  4. WebMethods Enterprise(WebMethods公司)
  5. BusinessWare(Vitria Technology公司)

**17.2 企业集成平台的实现**

- 数据集成

  数据集成主要有以下三种模式：

  1. 数据联邦

     不同的应用共同访问一个全局虚拟数据库。

     <img src="https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905233505398.png" alt="image-20200905233505398" style="zoom: 67%;" />

  2. 数据复制

     通过底层应用数据源之间的一致性复制来实现不同应用之间的信息共享和互操作。

     <img src="https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905233607289.png" alt="image-20200905233607289" style="zoom:67%;" />

  3. 基于接口的数据集成

     不同的应用系统之间利用适配器提供的应用编程接口来实现相互调用。

     <img src="https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905233941280.png" alt="image-20200905233941280" style="zoom:67%;" />

- 应用集成

  应用集成是指两个或多个应用系统根据业务逻辑的需要而进行的功能之间的相互调用和互操作。

  应用集成模式包括

  1. 集成适配器模式

     在应用系统提供的API基础上，通过适配器完成不同的系统间数据格式及访问方式的转换与映射。

     ![image-20200905234445029](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905234445029.png)

  2. 集成信使模式

     系统之间的通信和数据交换通过信使来实现。

     ![image-20200905234535994](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905234535994.png)

  3. 集成面板模式

     与设计模式中模板模式很相似，它是从应用交互实现的层面来描述客户端应用和服务器端应用集成的一种方法。

     ![image-20200905234812221](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905234812221.png)

  4. 集成代理模式

     它仅需要将待集成的应用间的交互逻辑从应用中分离出来，并对应用间的交互逻辑进行封装，进而由集成代理来引导多个应用之间的交互。

     ![image-20200905235001872](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200905235001872.png)

- 企业集成

  企业应用软件系统从功能逻辑上可以分为表示、业务逻辑和数据三个层次。在软件系统具体实现上可以大致分为如下4类。

  1. 单层结构系统

     这种应用一般是采用传统的编程方法得到的一个紧密结构应用；

  2. 两层结构系统

     通常是将表示层与业务逻辑层紧密地耦合在一起；

  3. 三层结构系统

     将业务应用系统的表示、业务逻辑和数据三个层次分成独立的模块实现；

  4. n层结构系统

     将三层系统结构进一步细化，提高系统不同业务功能模块的独立性。

**17.3 企业集成的关键应用技术**

- 数据交换格式

  企业数据集成中常用的几种数据格式如下：

  1. EDI（Electronic Data Interchange, 电子数据交换）

  2. XML

  3. STEP（Standard for the Exchange of Product Model Data）

  4. PDML

     是一个用来发布和使用集成产品数据的相关标准和工具的集合。

- 分布式应用集成基础框架

  当今分布式对象技术中，比较有影响的分布式软件对象标准有三种。

  1. CORBA

     Common Object Request Broker Architecture，公共对象请求代理体系结构。

  2. COM+

     COM+是Microsoft公司基于Windows平台的一个分布式企业应用模型。

  3. J2EE

     Java 2 Platform Enterprise Edition，Java 2平台企业版，是由Sun公司制定的基于Java技术的分布式组件计算平台规范。

     J2EE标准的典型运行结构中，主要包含客户层、Web层、业务逻辑层和数据层。

     ![image-20200906213936018](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200906213936018.png)

  4. Web Service

     指服务提供者将应用作为服务部署在Web上，通过使用Web服务描述语言来描述特定Web服务提供的功能。

     ![image-20200906214640651](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200906214640651.png)

**17.4 面向整体解决方案的企业模型**

- 企业模型在整体解决方案中的作用

  企业建模的作用主要表现在以下几个方面。

  1. 企业模型可以提供对企业公共一致的、规范的表达和描述。
  2. 基于模型的分析是信息化工作的入手点，也是建立有效实施途径的基础。
  3. 建模可以对信息系统规划方案进行预评价。
  4. 基于模型的工作流执行可以监控各信息系统之间及信息系统与外界的交互。

- 整体解决方案中的企业模型重用

  集成化企业建模体系框架中定义了三个实现企业模型重用的通用性层次：

  1. 通用层

     提供了整个集成体系结构的基本构成成分。

  2. 部分通用层

     在通用模型层的基础上。

  3. 专用层

     根据企业实际情况和需求，选择一定的参考模型并进行适当改动。

  参考模型的选择具体包括以下几个步骤：

  1. 确定企业建模的目标和基本需求；
  2. 划定企业建模的范围。
  3. 提出候选参考模型。
  4. 确定最终使用的参考模型。

- 整体解决方案中企业模型演化

  信息系统实施的生命周期可以分成4个阶段：

  1. 需求分析阶段

     主要完成企业业务策略、信息技术/系统策略的确定与分析。

  2. 系统设计阶段

     主要完成企业目标模型的确定和信息系统集成框架的求解。

  3. 系统实施阶段

     主要完成整体解决方案指导下的信息系统构建。

  4. 运行维护阶段

     主要完成对投入运行的企业集成化系统的运行维护。

- 模型驱动的企业集成系统演化

  ![image-20200906220827046](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200906220827046.png)

  首先，经过集成平台实施形成了企业信息系统集成框架；

  随着市场的变化、技术的进步，企业的核心能力及竞争策略可能要做相应的调整；

# 第18章 面向方面的编程

**18.1 方面编程的概念**

- AOP产生的背景

  1. 面向过程编程面临的问题

     在大型应用系统中，自顶向下的编程方法在以下方面存在不足：体系结构的确立、系统的进化和维护、软件重用性。

  2. 传统面向对象编程面临的问题

     设计阶段：不能全面地反映软件系统的需求；

     编码阶段：有一些数据和方法是特定于应用的，因此减少了代码重用的可能性；

     维护阶段：类中夹杂了各种特定于应用的代码，难以理解及维护；

  3. AOP的产生

     2001年3月15日，Palo Alto研究中心发布了首种支持AOP的语言AspectJ。

- 面向方面的原因

  下图a表现了一个含有三个类的程序，水平线表示代码行相应的横切功能性，如日志功能。

  图b显示使用了方面处理日志功能的同样的程序，类与这些代码分离了。

  ![image-20200906223107518](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200906223107518.png)

  用这种方法设计的程序比没用使用方面的程序容易编写、维护和改编。

- AOP技术

  AOP可以说是OOP的补充和完善。它利用"横切"的技术，剖解开封装的对象内部，并将那些影响了多个类的公共行为封装到一个可重用模块，命名为Aspect。

  AOP技术主要分为两大类：

  1. 动态代理技术

  2. 静态织入

     使编译器在编译期间织入有关"方面"的代码。

  join point（连接点）：程序执行中的一个精确执行点。例如类中的一个方法；

  point cut（切入点）：一个捕获连接点的结构；

  advice（通知）：是 point cut 的执行代码；

  aspect（方面）：point cut 和 advice 结合起来就是 aspect；

  introduce（引入）：为对象引入附加的方法或属性；

- AOP特性

  1. 可扩展性：通过扩展 Aspect 或增加 Aspect；
  2. 可重用性：AOP通过将实现基本功能的组件和特定于应用的系统特性分离，使得组件的重用性得到提高；
  3. 易理解性和易维护性：AOP对一个aspect的修改可以通过联结器影响到系统相关的各个部分，大大提高了系统的易维护性；

- AOP程序设计

  AOP程序结构：一种aspect语言、合并aspect的纺织器、利用组件语言实现的系统组件；

  AOP程序设计步骤：功能分解、编码实现、组合aspect代码；

- AOP的优势

  质量及风险：在AOP中需要从外向内来看，并确定在可能的连接点上每个方面的效果；

  构建软件方面：AOP开发出经得起考验的一组工具与流程；

- 当前的AOP技术

  AspectJ、AspectWerkz、JBoss AOP、Spring AOP；

**18.2 AspectJ**

- AspectJ概述

  Aspect既是一个语言规范，又是一个AOP语言实现。AspectJ编译器生成的是符合Java字节码规范的.class文件，这使得所有符合规范的Java虚拟机都可以解释、执行其所生成的代码。

- AspectJ语言概念和构造

  1. 连接点

     方法的调用和执行、构造器的调用和执行、对属性的读写访问、异常处理的执行、对象和类的初始化执行；

  2. 切入点

     方法调用和构造器调用、方法执行和构造器执行、属性访问、异常处理、类初始化、基于语法结构、基于控制流、基于当前对象、条件测试；

  3. 通知

     before、after、around

  4. 方面

     方面是Aspect的模块单元，相当于Java里的类。

- AspectJ实践

  1. 定义连接点

     ![image-20200909232610255](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200909232610255.png)

     ```java
     pointcut emplyeeUpdates(Employee e):call(public void Employee.update*Info()) && target(e);
     ```

     ```java
     pointcut employeeFinanceUpdate(Employee e):call(public void update*Info(Employee)) && args(e);
     ```

  2. 编写日志代码

     ```java
     public aspect EmployeeChangeLogger {
     	pointcut employeeUpdates(Employee e):call(public void Employee.update*Info()) && target(e);
         
         pointcut employeeFinanceUpdate(Employee e):call(public void update*Info(Employee)) && args(e);
         
         after(Employee) returning:employeeUpdates(e) || employeeFinanceUpdates(e) {
             System.out.println("\t>Employee : " + e.getName() + " has had a change");
             System.out.println("\t>Changed by " + thisJoinPoint.getSignature());
         }
     }
     ```

  3. 编译及测试

     ```java
     public static void main(String[] args) {
         // Do something to change some of the employee's information here.
         Employee e = new Employee("Chris Smith");
         // Updating job information
         e.updateJobInfo();
         // Updateing office information
         e.updateOfficeInfo();
         // Updating federal tax information
         EmployeeFinance.updateFederalTaxInfo(e);
         // Updating state tax information
         EmployeeFinance.updateStateTaxInfo(e);
     }
     ```

     使用AspectJ编译器ajc进行编译，这种纺织在Java字节码级别发生，可以对Java字节码进行反编译查看。

**18.3 Spring AOP**

- Spring AOP概述

  Core、DAO、ORM、Spring AOP、Spring Web

- Spring语言概念和构造

  AOP在Spring中的使用：提供声明式企业服务、允许用户实现自定义的方面；

  Spring AOP的功能：支持拦截方法调用、和Spring IoC紧密整合；

  Spring AOP的重要概念：方面、连接点、通知、切入点、引入、目标对象、AOP代理、织入。

- Spring AOP应用

  使用Spring AOP松散耦合的几种方式：

  1. 创建通知

     Spring AOP提供了4种通知的接口：MethodBeforeAdvice、AfterReturningAdvice、ThrowsAdvice、MethodInterceptor

  2. 在Spring中定义切入点

     Spring中切入点框架的核心是Pointcut接口，提供了PointcutAdvisor、StaticMethodMatherPointcut、RegexpMethodPointcut、ControlFlowPointcut

  3. 用ProxyFactoryBean创建AOP代理

     如果定义一个名字为myfactory的ProxyFactoryBean，引用myfactory的对象所看到的不是ProxyFactoryBean实例本身，而是由实现ProxyFactoryBean的类的getObject()方法所创建的对象。

  4. 自动代理

     Spring提供了通过容器来自动创建代理的功能。Spring提供了两个类实现自动代理：BeanNameAutoProxyCreator和DefaultAdvisorAutoProxyCreator。

# 第19章 嵌入式系统设计

**19.1 嵌入式系统**

- 嵌入式系统概念

  1. 嵌入式系统的基本概念

     一种以应用为中心，以计算机技术为基础，集可配置可裁减的软、硬件于一体的专用计算机系统；

     特点：系统专用性强、系统实时性强、软硬件依赖性强、处理器专用、多种技术紧密结合、系统透明性、系统资源受限。

  2. 嵌入式系统的实时概念

     兼有实时系统的特性和嵌入式系统特性的系统称为实时嵌入式系统。

  3. 嵌入式系统的分类

     按嵌入方式：整机式嵌入、部件式嵌入、芯片式嵌入

     按嵌入程度：深度嵌入、中度嵌入、浅度嵌入

     按实时性：实时嵌入式系统、非实时嵌入式系统

     按复杂程度：单微处理器嵌入式系统、组件式嵌入式系统、分布式嵌入式系统

  4. 嵌入式系统的应用领域

     工业、家电、商业、金融、交通、通信、建筑、环境监测、医疗卫生；

- 嵌入式系统的基本架构

  嵌入式系统一般由软件和硬件两个部分组成：

  ![image-20210826223440227](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/20210826223440.png)

  硬件平台：嵌入式微处理器、嵌入式微控制器、嵌入式数字信号处理器、嵌入式分片系统。

  软件架构：设备驱动管理层、嵌入式操作系统、支撑软件和应用软件。

  ![image-20210826223635148](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/20210826223635.png)

- 嵌入式操作系统

  概念与特点：微型化、代码质量高、专业化、实时性强、可裁减可配置。

  分类：商业型、非商业型；实时型、非实时型。

  一般结构：

  ![image-20210826223659864](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/20210826223659.png)

  多任务调度：任务优先级分配方法、时间轮转调度、任务操作。

  内核对象：信号量、消息队列、管道、事件、信号。

  实时嵌入式操作系统的内核服务：异常和中断、计时器、I/O管理。

  内存管理：固定尺寸内存池内存管理、阻塞与非阻塞的内存函数、硬件内存管理单元、同步与通信。

- 典型嵌入式操作系统

  ECOS、EPOC、IOS、LynxOS、Nucleus、OS-9、pSOS、QNX、VxWorks。

- 嵌入式数据库管理

  1. 嵌入式数据库管理系统概述

     嵌入式数据库管理系统就是在嵌入式设备上使用的数据库管理系统。

  2. 嵌入式数据库管理系统使用环境的特点

     设备随时移动性、网络频繁断接、网络条件多样化、通信能力不对称。

  3. 嵌入式数据库管理系统组成

     包括主数据库管理系统、同步服务器、嵌入式数据库管理系统、连接网络。

     在应用中，嵌入式移动数据库关键要解决好数据的一致性、高效的事务处理和数据安全性等问题。

     移动数据库管理系统的特性：微核结构、对标准SQL的支持、事务管理功能、完善的数据同步机制、支持多种连接协议、完备的嵌入式数据库管理功能、支持多种嵌入式操作系统。

  4. 嵌入式移动数据库管理系统的应用

     主要用于以移动信息设备为终端、需要定期汇总的金融、零售、医疗、公安、保险、工业制造、仓储、电信。

  5. 嵌入式数据库管理系统案例

     SQL Anywhere Studio是Sybase公司开发的一个嵌入式数据库系统。

- 嵌入式网络及其他

  嵌入式网络是用于连接各种嵌入式系统，使之可以互相传递信息、共享资源的网络系统。

**19.2 嵌入式系统的设计**

- 嵌入式系统分析与设计

  设计的核心技术：处理器技术、IC技术、设计/验证技术。

  系统的设计流程：

  ![image-20210826223823448](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/20210826223823.png)

- 嵌入式软件设计模型

  1. 状态机模型

     一种描述系统状态及其状态转换的节点网，包括节点和边，节点表示状态，边表示状态之间的转换关系。

     ![image-20210826223848307](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/20210826223848.png)

     特点：输出由当前的输入和当前的状态决定、当前的状态由过去的输入决定、当前的状态是上一步输出的反映、输出受输入顺序的影响。

- 嵌入式系统软件开发环境

  1. 嵌入式系统开发概述

     嵌入式系统的软件开发采用交叉平台开发方法，即软件在一个通用的平台上开发，而在另一个嵌入式目标平台上运行。

  2. 调试方法

     直接测试法、调试监控法、在线仿真法、片上调试法及模拟器法。

  3. 开发环境分类

     与嵌入式操作系统配套的开发环境、与处理器芯片配套的开发环境、与具体应用平台配套的开发环境、其他类。

# 第20章 面向服务的架构

**20.1 SOA的相关概念**

- SOA的定义

  从应用的角度定义，SOA是一种应用框架，它将业务应用划分为单独的业务功能和流程，即所谓的服务。

  从软件的基本原理定义，可认为SOA是一个组件模型，它将应用程序的不同功能单元（称为服务）通过这些服务之间定义良好的接口和契约联系起来。

- 业务流程与BPEL

  业务流程是指为了实现某种业务目的所进行的流程或一系列动作。

  BPEL（Business Process Execution Language For Web Services）面向Web服务的业务流程执行语言。

**20.2 SOA的发展历史**

- SOA的发展历史

  SOA的发展初始于国外，经历了三个阶段：

  1. 萌芽阶段：这一阶段以XML技术为标志，XML为SOA的兴起奠定了基石。

  2. 标准化阶段：人们提出了Web服务的概念，希望通过将企业对外服务封装为基于统一标准的Web服务，实现异构系统之间的简单交互。

     这一时期出现了三个著名的Web服务标准和规范：SOAP、WSDL、UDDI。

  3. 成熟应用阶段

     从2005年开始，SOA推广和普及工作开始加速。

     SCA和SDO构成了SOA编程模型的基础，而WS-Policy建立了SOA组件之间安全交互的规范。这三个规范的发布，标志着SOA进入了实施阶段。

- 国内SOA的发展现状与国外对比

  2007年IDC发布了《SOA中国路线图》，可取之处如下：

  1. 指出了中美IT系统所面临的根本性问题不同

     美国对已有系统中的功能进行提取和包装，形成标准的服务；

     中国主要是以构建支撑某一业务的应用系统为主。

  2. 为国内大型企业指明了如何解决系统集成和系统构建的整合性问题

**20.3 SOA的参考架构**

企业集成的架构可划分为6大类：

1. 业务逻辑服务；
2. 控制服务；
3. 连接服务；
4. 业务创新和优化服务；
5. 开发服务；
6. IT服务管理；

- 连接服务--企业服务总线

  ESB采用总线结构模式简化了应用之间的集成拓扑，使得服务请求者和服务提供者之间可以松散耦合。

- 业务逻辑服务

  应用和信息访问服务：可接入服务、事件发现服务；

  业务应用服务：组件服务、核心服务、接口服务；

  伙伴服务：社区服务、文档服务、协议服务；

- 控制服务

  信息服务：联邦服务、复制服务、转换服务、搜索服务；

  流程服务：编排服务、事务服务、人工服务；

  交互服务：交付服务、体验服务、资源服务；

- 开发支持

  用于支持以服务为中心的企业集成方法学和建模：SODA和IBM的SOMA；

  用于服务为中心的编程模型：WSDL、BPEL4WS、SCA和SDO等；

- 业务创新和优化

  业务创新的优化服务由以下服务组成：

  1. 公共事件框架服务：通过一个公共事件框架提供IT和业务事件的激发、存储和分类等；
  2. 采集服务：通过基于策略的过滤和相关性分析检测感兴趣的服务；
  3. 监控服务：通过事件与监控上下文间的映射，计算和管理业务流程的关键性能指标；

- 管理支持

  安全和目录服务：企业范围的用户、认证和授权管理（如单点登录 ）；

  系统管理和虚拟化服务：用于管理服务器、存储、网络和其他IT资源；

**20.4 SOA主要技术和标准**

![image-20200913235535493](https://gitee.com/yanglu_u/ImgRepository/raw/master/images/image-20200913235535493.png)

- UDDI协议

  UDDI，统一描述、发现和集成协议，它使得商业实体能够彼此发现；

- WSDL规范

  WSDL（Web Services Description Language，Web服务描述语言），是一个用来描述Web服务和说明如何与Web服务通信的XML语言。

  通过WSDL，可描述Web服务的三个基本属性：服务做些什么、如何访问服务、服务位于何处；

- SOAP协议

  SOAP是在分布式环境中变换信息的简单的协议，是一个基于XML的协议。包括4个部分：SOAP封装、SOAP编码规则、SOAP RPC表示、SOAP绑定；

**20.5 SOA的特性**

- 文档标准化
- 通信协议标准
- 应用程序统一登记与集成
- 可靠性、安全性

**20.6 SOA的作用**

SOA实现企业资源共享，把应用和资源转换成服务，并把这些服务变成标准的服务，形成资源的共享。

**20.7 SOA设计原则**

服务的设计原则：

1. 无状态：应避免服务请求者依赖于服务提供者的状态；
2. 单一实例：避免功能冗余；
3. 明确定义的接口：服务定义必须长时间稳定；
4. 自包含和模块化：服务封装那些业务上稳定、重复出现的活动和组件；
5. 粗粒度：服务数量不应该太多；
6. 服务之间的松耦合性：只暴露服务接口，位置、实现技术、状态是不可见的；
7. 重用能力：服务可以重用；
8. 互操作性、兼容和策略声明：WS-Policy用于定义可配置的互操作语义，描述特定服务的期望、控制其行为；

**20.8 SOA的设计模式**

- 服务注册表模式
- 企业服务总线模式

**20.9 构建SOA架构时应该注意的问题**

- 原有系统架构中的集成需求
- 服务粒度的控制以及无状态服务的设计

**20.10 SOA实施的过程**

- 选择SOA解决方案
- 业务流程分析

# 第21章 案例研究

**21.1 价值驱动的体系结构：连接产品策略与体系结构**

**21.2 使用RUP和UML开发联邦企业体系结构框架**

**21.3 Web服务在HL7上的应用--Web服务基础实现框架**

**21.4 以服务为中心的企业整合--案例分析**